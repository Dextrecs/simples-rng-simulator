:root {
    --bg: #f4f7f6;
    --text: #333;
    --card: #fff;
    --primary: #4CAF50;
    --danger: #f44336;
    --border: #ddd;
}

body.dark-mode {
    --bg: #1e1e1e;
    --text: #f0f0f0;
    --card: #2d2d2d;
    --primary: #66BB6A;
    --danger: #ef5350;
    --border: #444;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: 0.3s;
}

#particleCanvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 0; }

header { padding: 20px; z-index: 2; text-align: center; }

.game-container {
    width: 95%;
    max-width: 1200px;
    background: var(--card);
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    z-index: 10;
    margin-bottom: 20px;
}

.header-status { text-align: right; margin-bottom: 15px; font-weight: bold; font-size: 1.2em; }

/* --- RESPONSIVE GRID --- */
.main-grid {
    display: grid;
    gap: 20px;
    grid-template-columns: 1fr; /* Default: Stacked (Mobile) */
    grid-template-areas: 
        "shop"
        "roll"
        "inventory";
}

/* PC View: Side by Side */
@media (min-width: 900px) {
    .main-grid {
        grid-template-columns: 1fr 2fr 1fr;
        grid-template-areas: "shop roll inventory";
    }
    .shop-panel { border-right: 1px solid var(--border); }
    .inventory-panel { border-left: 1px solid var(--border); }
}

.grid-panel { padding: 10px; }
.shop-panel { grid-area: shop; }
.roll-center-panel { grid-area: roll; text-align: center; }
.inventory-panel { grid-area: inventory; }

/* --- BUTTONS & UI --- */
button {
    cursor: pointer;
    padding: 8px 12px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    background: var(--primary);
    color: white;
    transition: 0.2s;
}
button:hover { opacity: 0.9; transform: scale(1.02); }
button:disabled { opacity: 0.5; cursor: not-allowed; }

.btn-sell, .btn-danger { background: var(--danger); }
.shop-actions { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px dashed var(--border); padding-bottom: 10px; }

/* --- ROLL AREA --- */
.roll-area { margin: 20px 0; min-height: 150px; }
#item-name { font-size: 2em; margin: 10px 0; }
#rarity-badge { background: #ccc; color: #333; padding: 5px 10px; border-radius: 15px; display: inline-block; }
#btn-roll { font-size: 1.5em; padding: 15px 40px; width: 100%; margin: 10px 0; }

.bottom-actions { display: flex; gap: 10px; }
.bottom-actions button { flex: 1; background: #2196F3; }

/* --- INVENTORY --- */
.inventory-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
.inventory-grid { 
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(50px, 1fr)); 
    gap: 5px; 
    max-height: 300px; 
    overflow-y: auto; 
}
.inv-item { 
    aspect-ratio: 1; 
    border-radius: 5px; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    font-size: 0.8em; 
    color: white; 
    text-shadow: 1px 1px 2px black;
    cursor: pointer;
    position: relative;
}
.inv-item.selected { border: 3px solid red; transform: scale(0.9); }

/* --- MODALS (THE BUG FIX) --- */
.modal {
    display: flex; /* Centers content */
    justify-content: center;
    align-items: center;
    position: fixed; /* Fixes it to screen */
    z-index: 2000; /* High priority */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.6); /* Dim background */
    backdrop-filter: blur(3px);
}

.modal-content {
    background-color: var(--card);
    padding: 20px;
    border-radius: 10px;
    width: 90%;
    max-width: 400px;
    position: relative;
    border: 1px solid var(--border);
    color: var(--text);
}

/* THIS CLASS HIDES THE MODALS */
.hidden {
    display: none !important;
}

.close { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; }

/* Settings Inputs */
.setting-group { margin: 15px 0; display: flex; justify-content: space-between; align-items: center; }
input[type=range] { width: 60%; }

/* Animations */
@keyframes pop { 0% { transform: scale(0.5); } 80% { transform: scale(1.1); } 100% { transform: scale(1); } }
